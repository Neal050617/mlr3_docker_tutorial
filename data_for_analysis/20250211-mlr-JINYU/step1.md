# 数据处理流程说明

## 数据清洗规则

### 1. 缺失值处理
- **统一NA标识**：将原始数据中的"Na"、"na"、"N/A"、"/"等非标准缺失标识统一转换为R语言标准NA
- **删除策略**：
  - 列级别：删除缺失值比例超过50%的特征列
  - 行级别：删除缺失值比例超过50%的样本行

### 2. 特殊符号替换
执行以下符号统一化处理：
- 双点号".." → 单点号"."
- 斜杠"/" → 点号"."
- 中英文逗号（","，"，"）→ 点号"."
- 中文尖括号"〈"、"〉" → 英文尖括号"<"、">"

### 3. 分类变量处理
- **性别转换规则**：
  - "男" → 数值1
  - "女" → 数值0
  - 其他情况标记为缺失值
- **年龄处理规则**：
  1. 清洗步骤：去除"岁"、"月"、"天"等中文字符
  2. 转换方法：
     - 纯数字直接转换为数值
     - 含多单位时进行累加换算：
       - 月数转换为年：月数/12
       - 天数转换为年：天数/365
  3. 精度控制：保留两位小数

### 4. 特征标准化
- **二分类变量转换**：
  - 0值对应："无"、"无效"、"否"
  - 1值对应："有"、"好转"、"是"
  - 非上述值统一标记为缺失
- **三分类变量处理**：
  - 将"有"统一转换为"是"以保持表述一致性

## 特征工程

### 1. 组织样本特征处理
- 方法：将原始的组织类型列转换为二进制特征矩阵
- 处理步骤：
  1. 每个样本对应多个组织类型
  2. 拆分后为每个组织类型创建独立列
  3. 存在该组织类型标记1，否则标记0

### 2. tNGS检测特征处理
- 方法：解析病原体检测结果并结构化
- 处理步骤：
  1. 拆分多病原体检测结果
  2. 提取病原体名称作为新特征
  3. 存在该病原体标记1，否则标记0

### 3. 临床特征处理
- 方法：解析临床症状描述
- 处理步骤：
  1. 拆分用逗号分隔的临床症状
  2. 为每个症状创建独立特征列
  3. 存在该症状标记1，否则标记0

## 数据合并规则

### 合并流程
1. 基础数据：经过清洗的主数据集
2. 依次左连接：
   - 组织样本特征矩阵
   - tNGS检测特征矩阵
   - 临床特征矩阵
